# Movie Genre Classification using TF-IDF + Naive Bayes

import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

TRAIN_FILE = "train_data.txt"

# LOADING & CLEANING OF DATA

def load_data(file_path):
    genres = []
    plots = []

    with open(file_path, "r", encoding="utf-8") as f:
        for line in f:
            parts = line.strip().split(" ::: ")
            genre = parts[-2].split("|")[0].lower().strip()
            plot = parts[-1].strip()
            genres.append(genre)
            plots.append(plot)

    return pd.DataFrame({"genre": genres, "plot": plots})

df = load_data(TRAIN_FILE)

print("Number of unique genres:", df["genre"].nunique())

# TRAIN_TEST_SPLIT
X_train, X_val, y_train, y_val = train_test_split(
    df["plot"],
    df["genre"],
    test_size=0.2,
    random_state=42,
    stratify=df["genre"]
)

# TF-IDF
vectorizer = TfidfVectorizer(
    stop_words="english",
    max_features=10000
)

X_train_vec = vectorizer.fit_transform(X_train)
X_val_vec = vectorizer.transform(X_val)

# MODEL
model = MultinomialNB()
model.fit(X_train_vec, y_train)

# EVALUATION
y_pred = model.predict(X_val_vec)
accuracy = accuracy_score(y_val, y_pred)

print("Validation Accuracy:", accuracy)

